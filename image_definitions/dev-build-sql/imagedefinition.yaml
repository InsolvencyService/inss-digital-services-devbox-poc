$schema: "1.0"
name: "dev-build-sql"
image: microsoftwindowsdesktop_windows-ent-cpc_win11-24H2-ent-cpc

tasks:
  - name: powershell
    description: "Install SQL Server 2022 Developer"
    parameters:
      command: |
        $installerPath = "C:\Temp\SQL2022.exe"
        if (-not (Test-Path "C:\Temp")) { New-Item -ItemType Directory -Path "C:\Temp" | Out-Null }
        Invoke-WebRequest -Uri "https://go.microsoft.com/fwlink/?linkid=866662" -OutFile $installerPath
        Start-Process -FilePath $installerPath -ArgumentList "/Q /ACTION=Install /FEATURES=SQLEngine /INSTANCENAME=MSSQLSERVER /IACCEPTSQLSERVERLICENSETERMS" -Wait -NoNewWindow

  - name: winget
    description: "Install Microsoft SQLServer Management Studio 21"
    parameters:
      package: Microsoft.SQLServerManagementStudio.21

